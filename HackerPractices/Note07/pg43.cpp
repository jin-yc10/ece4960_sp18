//
// Created by yj374 on 4/29/18.
//

#include <opencv2/opencv.hpp>

/*
OUTPUT:
 [0.33333334, 0, 0, 0, 0;
  0.11111112, 0.33333334, 0, 0, 0;
  0.037037041, 0.11111112, 0.33333334, 0, 0;
  0.012345681, 0.037037041, 0.11111112, 0.33333334, 0;
  0.0041152271, 0.012345681, 0.037037041, 0.11111112, 0.33333334]
[1, 0, 0, 0, 0;
  0, 1, 0, 0, 0;
  0, 0, 1, 0, 0;
  0, 0, 0, 1, 0;
  0, 0, 0, 0, 1]
1 [0, 0, 10, 0, 0]
2 [0, 0, 3.3333335, 1.1111112, 0.37037042]
3 [0, 0, 1.1111112, 0.74074084, 0.37037042]
4 [0, 0, 0.37037039, 0.37037042, 0.24691363]
5 [0, 0, 0.1234568, 0.16460907, 0.13717423]
6 [0, 0, 0.041152269, 0.068587117, 0.068587117]
 */

int main(int argc, char** argv) {
	float h=1, dlt=1, D=1, f=0;
	float vi[5] = {0, 0, 10, 0, 0};
	cv::Mat n(5, 1, CV_32F, vi);
	cv::Mat Ainv = cv::Mat::eye(5,5,CV_32F)*(1/dlt+2*D/(h*h));
	for( int i=0; i<4; i++) {
		Ainv.at<float>(i+1, i) = -D/dlt;
	}
	Ainv = Ainv.inv();
	cv::Mat B = cv::Mat::eye(5,5,CV_32F) / dlt;
	std::cout << Ainv << std::endl;
	std::cout << B << std::endl;
	
	for(float t=1; t<7; t++) {
		std::cout << t << " " << n.t() << std::endl;
		n = B * Ainv * n;
	}
	return 0;
}